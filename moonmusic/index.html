<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Heart, Crescent Moon, and Rainbow Animation</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            background-color: #0d335f;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }
        .controls-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 600px;
            margin: 20px auto;
            padding: 20px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }
        canvas {
            border: 2px solid white;
            max-width: 100%;
            height: auto;
        }
        .plyr, .default-player {
            margin-top: 20px;
            width: 100%;
            max-width: 300px;
        }
        .default-player {
            display: none;
        }
        /* Custom CSS for default HTML5 audio player */
        .default-player audio {
            width: 100%;
            background-color: #f1f3f4;
            border-radius: 4px;
            padding: 5px;
        }
        .default-player audio::-webkit-media-controls-panel {
            background-color: #f1f3f4;
        }
        .default-player audio::-webkit-media-controls-current-time-display,
        .default-player audio::-webkit-media-controls-time-remaining-display {
            color: #5f6368;
        }
        #audio-upload, #shape-selector {
            margin: 10px 0;
            padding: 10px;
            width: 100%;
            max-width: 300px;
        }
        #song-title {
            color: white;
            margin-top: 10px;
            font-size: 18px;
            text-align: center;
            max-width: 300px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        @media (max-width: 768px) {
            .controls-container {
                padding: 10px;
            }
            canvas {
                width: 100%;
                height: auto;
            }
        }
    </style>

    <!-- Include Plyr CSS -->
    <link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css" />
</head>
<body>
<h2 style="color: white;">Coldplay audio player</h2>
<div class="controls-container">
    <input type="file" id="audio-upload" accept="audio/*" />
    <select id="shape-selector">
        <option value="heart">Coldplay</option>
        <option value="moon">Crescent Moon</option>
        <option value="rainbow">Rainbow</option>
    </select>

    <!-- Display the song title here -->
    <h2 id="song-title"></h2>

    <!-- Audio element for Plyr -->
    <audio id="player" class="plyr" controls></audio>

    <!-- Default HTML5 audio player -->
    <div class="default-player">
        <audio id="default-player" controls></audio>
    </div>
</div>

<!-- Include Plyr JS -->
<script src="https://cdn.plyr.io/3.7.8/plyr.polyfilled.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/addons/p5.sound.min.js"></script>

<script>
let amplitude, fft;
let song;
let shapes = [];
let numShapes = 10;
let selectedShape = 'heart';
let player;

function setup() {
    let canvas = createCanvas(600, 600);
    canvas.parent(document.body);
    canvas.style('max-width', '100%');
    canvas.style('height', 'auto');

    amplitude = new p5.Amplitude();
    fft = new p5.FFT();

    for (let i = 0; i < numShapes; i++) {
        let x = random(width);
        let y = random(height);
        shapes.push({x: x, y: y});
    }

    let fileInput = document.getElementById('audio-upload');
    fileInput.addEventListener('change', handleFileUpload);

    let shapeSelector = document.getElementById('shape-selector');
    shapeSelector.addEventListener('change', function() {
        selectedShape = this.value;
    });

    // Initialize Plyr with fallback
    try {
        player = new Plyr('#player');
    } catch (error) {
        console.error('Plyr initialization failed:', error);
        document.querySelector('.plyr').style.display = 'none';
        document.querySelector('.default-player').style.display = 'block';
    }
}

function draw() {
    background('#0d335f');

    if (!song || !song.isPlaying()) {
      return;
    }

    let level = amplitude.getLevel();
    let size = map(level, 0, 1, 0.5, 1.5); // Escala de la mida de la forma

    let spectrum = fft.analyze();
    let bass = fft.getEnergy("bass");
    let treble = fft.getEnergy("treble");

    let r = map(bass, 0, 255, 50, 255);
    let b = map(treble, 0, 255, 50, 255);
    let g = map(level, 0, 1, 50, 255);

    noFill();
    stroke(r, g, b);
    strokeWeight(3);
    fill(r,g,b);//aquesta línea nova omple de color rgb i l'anterior feia el contorn.
    //the previous line fills the shapes below with the rgb colors obtained from sound frequencies (bass and treble) and volume (level)

    // Dibuixar múltiples formes (cors, llunes o arcs de Sant Martí)
    shapes.forEach(shape => {
      push();
      translate(shape.x, shape.y);
      scale(size);

      if (selectedShape === 'heart') {
          drawHeart(); // Dibuixa el cor
      } else if (selectedShape === 'moon') {
          drawCrescentMoon(); // Dibuixa la lluna creixent
      } else if (selectedShape === 'rainbow') {
          drawRainbow(); // Dibuixa l'arc de Sant Martí
      }

      pop();
   });
}

function drawHeart() {
  beginShape();//c from coldplay
vertex(136, 25.1875);
vertex(125, 25.1875);
vertex(114, 28.1875);
vertex(107, 33.1875);
vertex(100, 43.1875);
vertex(97, 54.1875);
vertex(98, 66.1875);
vertex(104, 76.1875);
vertex(113, 82.1875);
vertex(123, 85.1875);
vertex(132, 85.1875);
vertex(126, 81.1875);
vertex(120, 78.1875);
vertex(115, 71.1875);
vertex(112, 62.1875);
vertex(110, 52.1875);
vertex(112, 44.1875);
vertex(118, 35.1875);
endShape(CLOSE);
    beginShape();//o from coldplay
vertex(171, 33.1875);
vertex(191, 24.1875);
vertex(209, 27.1875);
vertex(219, 36.1875);
vertex(224, 43.1875);
vertex(226, 52.1875);
vertex(226, 61.1875);
vertex(223, 69.1875);
vertex(217, 76.1875);
vertex(211, 80.1875);
vertex(199, 85.1875);
vertex(189, 84.1875);
vertex(178, 81.1875);
vertex(167, 72.1875);
vertex(164, 61.1875);
vertex(163, 50.1875);
endShape(CLOSE);
    beginShape();//l from coldplay
    vertex(265, 28.1875);
vertex(258, 35.1875);
vertex(254, 46.1875);
vertex(253, 57.1875);
vertex(257, 67.1875);
vertex(266, 77.1875);
vertex(276, 81.1875);
vertex(289, 83.1875);
vertex(300, 79.1875);
vertex(308, 72.1875);
vertex(304, 73.1875);
vertex(298, 75.1875);
vertex(290, 76.1875);
vertex(281, 76.1875);
vertex(275, 72.1875);
vertex(267, 67.1875);
vertex(263, 60.1875);
vertex(259, 51.1875);
vertex(259, 44.1875);
vertex(264, 33.1875);
endShape(CLOSE);
    beginShape();//d form coldplay
vertex(336, 29.1875);
vertex(344, 26.1875);
vertex(355, 28.1875);
vertex(365, 32.1875);
vertex(372, 41.1875);
vertex(376, 53.1875);
vertex(375, 65.1875);
vertex(371, 74.1875);
vertex(364, 80.1875);
vertex(355, 84.1875);
vertex(345, 86.1875);
vertex(337, 85.1875);
vertex(344, 80.1875);
vertex(351, 74.1875);
vertex(356, 64.1875);
vertex(358, 50.1875);
vertex(355, 42.1875);
vertex(348, 34.1875);
vertex(341, 30.1875);
endShape(CLOSE);
    beginShape();//p form coldplay
vertex(404, 41.1875);
vertex(415, 30.1875);
vertex(428, 28.1875);
vertex(439, 30.1875);
vertex(447, 35.1875);
vertex(453, 43.1875);
vertex(458, 52.1875);
vertex(458, 62.1875);
vertex(456, 73.1875);
vertex(450, 79.1875);
vertex(445, 83.1875);
vertex(450, 67.1875);
vertex(449, 59.1875);
vertex(446, 52.1875);
vertex(438, 43.1875);
vertex(430, 40.1875);
vertex(420, 37.1875);
endShape(CLOSE);
    beginShape();//l from coldplay
vertex(495, 30.1875);
vertex(488, 38.1875);
vertex(484, 50.1875);
vertex(486, 65.1875);
vertex(492, 74.1875);
vertex(501, 80.1875);
vertex(512, 85.1875);
vertex(521, 84.1875);
vertex(529, 80.1875);
vertex(537, 75.1875);
vertex(531, 76.1875);
vertex(523, 77.1875);
vertex(512, 77.1875);
vertex(506, 73.1875);
vertex(495, 65.1875);
vertex(491, 54.1875);
vertex(491, 44.1875);
vertex(494, 34.1875);
endShape(CLOSE);
    beginShape();//a from coldplay
vertex(563, 65.1875);
vertex(564, 54.1875);
vertex(568, 44.1875);
vertex(574, 36.1875);
vertex(583, 31.1875);
vertex(593, 30.1875);
vertex(602, 32.1875);
vertex(609, 35.1875);
vertex(616, 42.1875);
vertex(621, 50.1875);
vertex(623, 60.1875);
vertex(623, 67.1875);
vertex(618, 59.1875);
vertex(613, 53.1875);
vertex(606, 48.1875);
vertex(600, 44.1875);
vertex(590, 43.1875);
vertex(580, 47.1875);
vertex(571, 53.1875);
vertex(567, 62.1875);
endShape(CLOSE);
    beginShape();//y from coldplay
vertex(646, 30.1875);
vertex(657, 36.1875);
vertex(664, 42.1875);
vertex(667, 49.1875);
vertex(670, 57.1875);
vertex(670, 66.1875);
vertex(666, 74.1875);
vertex(660, 80.1875);
vertex(650, 86.1875);
vertex(657, 88.1875);
vertex(666, 86.1875);
vertex(675, 79.1875);
vertex(680, 70.1875);
vertex(681, 60.1875);
vertex(680, 50.1875);
vertex(675, 43.1875);
vertex(668, 36.1875);
vertex(660, 31.1875);
endShape(CLOSE);
    beginShape();//cercle from coldplay
vertex(687, 31.1875);
vertex(696, 32.1875);
vertex(701, 38.1875);
vertex(699, 47.1875);
vertex(692, 50.1875);
vertex(684, 47.1875);
vertex(681, 40.1875);
vertex(683, 33.1875);
endShape(CLOSE);
   
}

function drawCrescentMoon() {
      scale(0.5);
    beginShape();//ala esquerra
vertex(294, 191.1875);
vertex(275, 189.1875);
vertex(262, 194.1875);
vertex(249, 204.1875);
vertex(239, 217.1875);
vertex(228, 231.1875);
vertex(218, 249.1875);
vertex(213, 264.1875);
vertex(210, 282.1875);
vertex(215, 293.1875);
vertex(212, 298.1875);
vertex(210, 313.1875);
vertex(211, 326.1875);
vertex(214, 345.1875);
vertex(217, 358.1875);
vertex(223, 367.1875);
vertex(225, 374.1875);
vertex(225, 388.1875);
vertex(229, 395.1875);
vertex(232, 404.1875);
vertex(239, 405.1875);
vertex(243, 413.1875);
vertex(246, 430.1875);
vertex(252, 446.1875);
vertex(259, 466.1875);
vertex(266, 480.1875);
vertex(270, 496.1875);
vertex(283, 517.1875);
vertex(297, 520.1875);
vertex(298, 528.1875);
vertex(302, 539.1875);
vertex(310, 540.1875);
vertex(314, 549.1875);
vertex(321, 557.1875);
vertex(323, 566.1875);
vertex(327, 576.1875);
vertex(333, 584.1875);
vertex(346, 583.1875);
vertex(353, 583.1875);
vertex(352, 586.1875);
vertex(360, 586.1875);
vertex(364, 594.1875);
vertex(371, 595.1875);
vertex(371, 599.1875);
vertex(379, 605.1875);
vertex(387, 595.1875);
vertex(386, 572.1875);
vertex(386, 546.1875);
vertex(382, 518.1875);
vertex(374, 483.1875);
vertex(369, 457.1875);
vertex(365, 440.1875);
vertex(365, 425.1875);
vertex(360, 407.1875);
vertex(368, 406.1875);
vertex(368, 379.1875);
vertex(361, 359.1875);
vertex(357, 347.1875);
vertex(363, 330.1875);
vertex(363, 305.1875);
vertex(345, 293.1875);
vertex(326, 279.1875);
vertex(314, 253.1875);
vertex(314, 228.1875);
vertex(309, 204.1875);
endShape(CLOSE);
    beginShape();//ala dreta
vertex(444, 351.1875);
vertex(437, 367.1875);
vertex(431, 391.1875);
vertex(434, 405.1875);
vertex(438, 406.1875);
vertex(436, 423.1875);
vertex(434, 435.1875);
vertex(439, 446.1875);
vertex(431, 452.1875);
vertex(428, 466.1875);
vertex(425, 478.1875);
vertex(421, 495.1875);
vertex(419, 512.1875);
vertex(419, 529.1875);
vertex(417, 549.1875);
vertex(415, 569.1875);
vertex(415, 587.1875);
vertex(417, 601.1875);
vertex(423, 607.1875);
vertex(430, 603.1875);
vertex(436, 595.1875);
vertex(440, 590.1875);
vertex(448, 585.1875);
vertex(456, 576.1875);
vertex(463, 581.1875);
vertex(474, 576.1875);
vertex(477, 555.1875);
vertex(483, 538.1875);
vertex(487, 542.1875);
vertex(498, 541.1875);
vertex(504, 523.1875);
vertex(503, 517.1875);
vertex(511, 519.1875);
vertex(517, 514.1875);
vertex(522, 504.1875);
vertex(529, 490.1875);
vertex(532, 477.1875);
vertex(535, 468.1875);
vertex(539, 460.1875);
vertex(543, 446.1875);
vertex(549, 429.1875);
vertex(553, 419.1875);
vertex(554, 411.1875);
vertex(559, 413.1875);
vertex(565, 408.1875);
vertex(567, 400.1875);
vertex(571, 389.1875);
vertex(572, 377.1875);
vertex(576, 371.1875);
vertex(581, 361.1875);
vertex(583, 347.1875);
vertex(585, 331.1875);
vertex(583, 323.1875);
vertex(587, 316.1875);
vertex(585, 306.1875);
vertex(575, 296.1875);
vertex(583, 298.1875);
vertex(589, 293.1875);
vertex(588, 280.1875);
vertex(585, 267.1875);
vertex(577, 238.1875);
vertex(559, 213.1875);
vertex(544, 198.1875);
vertex(530, 192.1875);
vertex(513, 189.1875);
vertex(500, 192.1875);
vertex(491, 205.1875);
vertex(484, 217.1875);
vertex(487, 232.1875);
vertex(485, 247.1875);
vertex(479, 262.1875);
vertex(468, 280.1875);
vertex(456, 295.1875);
vertex(447, 300.1875);
vertex(439, 307.1875);
vertex(437, 321.1875);
vertex(439, 338.1875);
endShape(CLOSE);
   
}

function drawRainbow() {
    beginShape();//centre cercles
vertex(67, 216.1875);
vertex(69, 199.1875);
vertex(73, 186.1875);
vertex(79, 176.1875);
vertex(87, 168.1875);
vertex(96, 162.1875);
vertex(106, 156.1875);
vertex(117, 153.1875);
vertex(128, 153.1875);
vertex(139, 153.1875);
vertex(151, 157.1875);
vertex(159, 161.1875);
vertex(170, 169.1875);
vertex(178, 179.1875);
vertex(183, 187.1875);
vertex(187, 199.1875);
vertex(189, 206.1875);
vertex(189, 218.1875);
vertex(191, 231.1875);
vertex(196, 243.1875);
vertex(203, 251.1875);
vertex(214, 262.1875);
vertex(227, 269.1875);
vertex(240, 272.1875);
vertex(255, 273.1875);
vertex(270, 270.1875);
vertex(282, 265.1875);
vertex(293, 256.1875);
vertex(304, 243.1875);
vertex(308, 230.1875);
vertex(312, 212.1875);
vertex(314, 198.1875);
vertex(321, 180.1875);
vertex(329, 168.1875);
vertex(341, 160.1875);
vertex(354, 153.1875);
vertex(370, 151.1875);
vertex(382, 151.1875);
vertex(393, 155.1875);
vertex(403, 159.1875);
vertex(411, 167.1875);
vertex(420, 175.1875);
vertex(426, 185.1875);
vertex(430, 196.1875);
vertex(432, 208.1875);
vertex(432, 223.1875);
vertex(427, 238.1875);
vertex(422, 249.1875);
vertex(415, 257.1875);
vertex(401, 266.1875);
vertex(389, 271.1875);
vertex(374, 273.1875);
vertex(355, 270.1875);
vertex(334, 259.1875);
vertex(321, 245.1875);
vertex(312, 229.1875);
vertex(308, 195.1875);
vertex(303, 182.1875);
vertex(292, 169.1875);
vertex(276, 158.1875);
vertex(256, 152.1875);
vertex(238, 152.1875);
vertex(223, 159.1875);
vertex(211, 166.1875);
vertex(201, 178.1875);
vertex(193, 192.1875);
vertex(190, 199.1875);
vertex(189, 216.1875);
vertex(187, 233.1875);
vertex(179, 249.1875);
vertex(167, 262.1875);
vertex(151, 270.1875);
vertex(133, 275.1875);
vertex(113, 273.1875);
vertex(98, 267.1875);
vertex(85, 257.1875);
vertex(74, 243.1875);
vertex(68, 228.1875);
endShape(CLOSE);
    beginShape();//cercles de fora
vertex(432, 187.1875);
vertex(427, 173.1875);
vertex(423, 161.1875);
vertex(415, 148.1875);
vertex(406, 136.1875);
vertex(400, 128.1875);
vertex(392, 121.1875);
vertex(383, 114.1875);
vertex(373, 108.1875);
vertex(362, 101.1875);
vertex(348, 97.1875);
vertex(332, 92.1875);
vertex(315, 91.1875);
vertex(300, 91.1875);
vertex(282, 93.1875);
vertex(268, 98.1875);
vertex(254, 103.1875);
vertex(243, 112.1875);
vertex(235, 117.1875);
vertex(226, 125.1875);
vertex(216, 137.1875);
vertex(208, 149.1875);
vertex(202, 160.1875);
vertex(197, 171.1875);
vertex(192, 184.1875);
vertex(190, 203.1875);
vertex(190, 218.1875);
vertex(190, 229.1875);
vertex(193, 245.1875);
vertex(200, 262.1875);
vertex(205, 275.1875);
vertex(216, 288.1875);
vertex(221, 296.1875);
vertex(229, 303.1875);
vertex(237, 311.1875);
vertex(250, 318.1875);
vertex(259, 325.1875);
vertex(272, 329.1875);
vertex(286, 333.1875);
vertex(297, 335.1875);
vertex(312, 336.1875);
vertex(328, 335.1875);
vertex(344, 331.1875);
vertex(361, 327.1875);
vertex(375, 319.1875);
vertex(389, 309.1875);
vertex(401, 296.1875);
vertex(413, 284.1875);
vertex(421, 268.1875);
vertex(426, 256.1875);
vertex(432, 238.1875);
vertex(434, 220.1875);
vertex(434, 207.1875);
vertex(430, 177.1875);
vertex(426, 157.1875);
vertex(420, 144.1875);
vertex(412, 124.1875);
vertex(400, 107.1875);
vertex(386, 89.1875);
vertex(369, 74.1875);
vertex(349, 58.1875);
vertex(329, 48.1875);
vertex(307, 38.1875);
vertex(286, 33.1875);
vertex(265, 30.1875);
vertex(243, 30.1875);
vertex(220, 32.1875);
vertex(196, 38.1875);
vertex(175, 45.1875);
vertex(155, 56.1875);
vertex(138, 67.1875);
vertex(123, 83.1875);
vertex(108, 97.1875);
vertex(97, 115.1875);
vertex(85, 135.1875);
vertex(76, 154.1875);
vertex(71, 174.1875);
vertex(68, 192.1875);
vertex(68, 216.1875);
vertex(67, 235.1875);
vertex(69, 247.1875);
vertex(77, 263.1875);
vertex(87, 280.1875);
vertex(98, 295.1875);
vertex(113, 309.1875);
vertex(128, 319.1875);
vertex(143, 327.1875);
vertex(165, 334.1875);
vertex(190, 335.1875);
vertex(207, 335.1875);
vertex(225, 331.1875);
vertex(244, 324.1875);
vertex(262, 313.1875);
vertex(273, 302.1875);
vertex(284, 290.1875);
vertex(299, 271.1875);
vertex(306, 250.1875);
vertex(311, 233.1875);
vertex(313, 209.1875);
vertex(307, 175.1875);
vertex(295, 152.1875);
vertex(283, 135.1875);
vertex(270, 121.1875);
vertex(255, 110.1875);
vertex(236, 101.1875);
vertex(220, 95.1875);
vertex(196, 90.1875);
vertex(172, 92.1875);
vertex(149, 97.1875);
vertex(128, 106.1875);
vertex(113, 118.1875);
vertex(100, 130.1875);
vertex(89, 143.1875);
vertex(81, 156.1875);
vertex(76, 168.1875);
vertex(71, 182.1875);
vertex(68, 198.1875);
vertex(67, 226.1875);
vertex(72, 254.1875);
vertex(76, 273.1875);
vertex(83, 291.1875);
vertex(93, 307.1875);
vertex(101, 319.1875);
vertex(108, 329.1875);
vertex(116, 338.1875);
vertex(127, 348.1875);
vertex(138, 357.1875);
vertex(151, 368.1875);
vertex(162, 374.1875);
vertex(177, 382.1875);
vertex(189, 386.1875);
vertex(208, 392.1875);
vertex(221, 394.1875);
vertex(235, 396.1875);
vertex(250, 397.1875);
vertex(266, 396.1875);
vertex(285, 393.1875);
vertex(306, 387.1875);
vertex(324, 382.1875);
vertex(345, 371.1875);
vertex(365, 357.1875);
vertex(378, 345.1875);
vertex(393, 330.1875);
vertex(400, 319.1875);
vertex(408, 305.1875);
vertex(416, 290.1875);
vertex(423, 274.1875);
vertex(429, 257.1875);
vertex(431, 245.1875);
endShape(CLOSE);
    beginShape();//primer planeta
vertex(112, 204.1875);
vertex(119, 198.1875);
vertex(128, 196.1875);
vertex(134, 199.1875);
vertex(140, 204.1875);
vertex(142, 212.1875);
vertex(141, 220.1875);
vertex(137, 225.1875);
vertex(130, 229.1875);
vertex(121, 229.1875);
vertex(115, 226.1875);
vertex(111, 219.1875);
vertex(109, 210.1875);
endShape(CLOSE);
    beginShape();//sol
vertex(236, 189.1875);
vertex(246, 184.1875);
vertex(255, 185.1875);
vertex(261, 187.1875);
vertex(268, 190.1875);
vertex(273, 196.1875);
vertex(277, 203.1875);
vertex(279, 213.1875);
vertex(278, 222.1875);
vertex(274, 229.1875);
vertex(268, 235.1875);
vertex(259, 239.1875);
vertex(248, 239.1875);
vertex(238, 237.1875);
vertex(230, 229.1875);
vertex(225, 220.1875);
vertex(225, 212.1875);
vertex(226, 201.1875);
vertex(231, 194.1875);
vertex(230, 200.1875);
vertex(234, 204.1875);
vertex(239, 206.1875);
vertex(246, 204.1875);
vertex(251, 200.1875);
vertex(258, 198.1875);
vertex(264, 196.1875);
vertex(269, 195.1875);
vertex(274, 199.1875);
vertex(272, 205.1875);
vertex(266, 211.1875);
vertex(258, 215.1875);
vertex(253, 217.1875);
vertex(248, 217.1875);
vertex(242, 217.1875);
vertex(234, 216.1875);
vertex(229, 214.1875);
vertex(225, 210.1875);
vertex(226, 201.1875);
vertex(234, 192.1875);
vertex(236, 190.1875);
vertex(240, 193.1875);
vertex(245, 193.1875);
vertex(250, 193.1875);
vertex(254, 192.1875);
vertex(260, 190.1875);
vertex(264, 189.1875);
vertex(268, 191.1875);
vertex(275, 198.1875);
vertex(278, 207.1875);
vertex(275, 213.1875);
vertex(272, 216.1875);
vertex(267, 220.1875);
vertex(260, 223.1875);
vertex(253, 224.1875);
vertex(245, 223.1875);
vertex(237, 222.1875);
vertex(233, 225.1875);
vertex(233, 228.1875);
vertex(233, 232.1875);
vertex(238, 232.1875);
vertex(245, 232.1875);
vertex(251, 232.1875);
vertex(259, 231.1875);
vertex(264, 229.1875);
vertex(269, 229.1875);
vertex(272, 229.1875);
vertex(279, 212.1875);
vertex(275, 198.1875);
vertex(267, 189.1875);
vertex(256, 185.1875);
vertex(243, 184.1875);
endShape(CLOSE);
    beginShape();//anell de l'últim planeta
vertex(356, 219.1875);
vertex(353, 223.1875);
vertex(357, 224.1875);
vertex(363, 223.1875);
vertex(369, 219.1875);
vertex(374, 216.1875);
vertex(382, 212.1875);
vertex(387, 208.1875);
vertex(390, 205.1875);
vertex(385, 204.1875);
vertex(387, 201.1875);
vertex(393, 199.1875);
vertex(397, 200.1875);
vertex(397, 206.1875);
vertex(391, 210.1875);
vertex(387, 214.1875);
vertex(381, 216.1875);
vertex(375, 220.1875);
vertex(369, 224.1875);
vertex(362, 227.1875);
vertex(354, 228.1875);
vertex(348, 228.1875);
vertex(348, 222.1875);
vertex(354, 217.1875)
endShape(CLOSE);
    beginShape();//tercer planeta
vertex(363, 202.1875);
vertex(359, 206.1875);
vertex(357, 212.1875);
vertex(357, 218.1875);
vertex(359, 223.1875);
vertex(362, 226.1875);
vertex(366, 230.1875);
vertex(371, 230.1875);
vertex(377, 228.1875);
vertex(382, 225.1875);
vertex(385, 220.1875);
vertex(386, 214.1875);
vertex(385, 210.1875);
vertex(383, 204.1875);
vertex(378, 201.1875);
vertex(372, 200.1875);
endShape(CLOSE);
    beginShape();//infinit
vertex(316, 296.1875);
vertex(311, 294.1875);
vertex(307, 294.1875);
vertex(306, 297.1875);
vertex(308, 298.1875);
vertex(312, 298.1875);
vertex(316, 297.1875);
vertex(319, 295.1875);
vertex(323, 293.1875);
vertex(328, 291.1875);
vertex(333, 291.1875);
vertex(336, 293.1875);
vertex(338, 297.1875);
vertex(336, 301.1875);
vertex(331, 302.1875);
vertex(326, 301.1875);
vertex(321, 299.1875);
vertex(319, 297.1875);
vertex(314, 295.1875);
vertex(309, 294.1875);
vertex(319, 297.1875);
vertex(320, 300.1875);
vertex(318, 301.1875);
vertex(313, 302.1875);
vertex(310, 302.1875);
vertex(306, 301.1875);
vertex(304, 298.1875);
vertex(303, 294.1875);
vertex(306, 291.1875);
vertex(311, 291.1875);
vertex(316, 291.1875);
vertex(321, 294.1875);
vertex(325, 297.1875);
vertex(328, 298.1875);
vertex(332, 298.1875);
vertex(335, 297.1875);
vertex(333, 294.1875);
vertex(329, 294.1875);
vertex(326, 295.1875);
endShape(CLOSE);
    beginShape();//punt blau
vertex(249, 292.1875);
vertex(252, 293.1875);
vertex(252, 295.1875);
vertex(250, 297.1875);
vertex(248, 295.1875);
endShape(CLOSE);
    beginShape();//planeta blanc
vertex(172, 294.1875);
vertex(175, 290.1875);
vertex(180, 289.1875);
vertex(184, 290.1875);
vertex(186, 293.1875);
vertex(186, 298.1875);
vertex(184, 299.1875);
vertex(179, 298.1875);
vertex(174, 295.1875);
vertex(170, 294.1875);
vertex(171, 291.1875);
vertex(170, 289.1875);
vertex(166, 286.1875);
vertex(160, 285.1875);
vertex(157, 286.1875);
vertex(157, 292.1875);
vertex(162, 295.1875);
vertex(165, 296.1875);
vertex(169, 298.1875);
vertex(172, 300.1875);
vertex(176, 301.1875);
vertex(182, 302.1875);
vertex(189, 304.1875);
vertex(194, 305.1875);
vertex(198, 305.1875);
vertex(203, 305.1875);
vertex(201, 301.1875);
vertex(199, 299.1875);
vertex(196, 297.1875);
vertex(191, 294.1875);
vertex(189, 294.1875);
vertex(190, 297.1875);
vertex(189, 300.1875);
endShape(CLOSE);
    beginShape();//planeta rosa
vertex(197, 360.1875);
vertex(200, 356.1875);
vertex(204, 355.1875);
vertex(206, 357.1875);
vertex(208, 360.1875);
vertex(208, 364.1875);
vertex(206, 367.1875);
vertex(202, 368.1875);
vertex(198, 366.1875);
endShape(CLOSE);
    beginShape();//planeta de colors
vertex(244, 347.1875);
vertex(250, 345.1875);
vertex(256, 345.1875);
vertex(261, 346.1875);
vertex(265, 349.1875);
vertex(268, 353.1875);
vertex(270, 358.1875);
vertex(270, 364.1875);
vertex(268, 370.1875);
vertex(265, 374.1875);
vertex(261, 377.1875);
vertex(255, 378.1875);
vertex(248, 377.1875);
vertex(243, 373.1875);
vertex(239, 367.1875);
vertex(238, 361.1875);
vertex(239, 356.1875);
vertex(241, 351.1875);
vertex(243, 349.1875);
vertex(247, 350.1875);
vertex(249, 352.1875);
vertex(249, 356.1875);
vertex(249, 359.1875);
vertex(247, 362.1875);
vertex(243, 364.1875);
vertex(242, 367.1875);
vertex(243, 370.1875);
vertex(246, 370.1875);
vertex(250, 371.1875);
vertex(254, 369.1875);
vertex(258, 369.1875);
vertex(262, 369.1875);
vertex(266, 368.1875);
vertex(267, 365.1875);
vertex(267, 363.1875);
vertex(263, 362.1875);
vertex(260, 362.1875);
vertex(254, 360.1875);
vertex(249, 358.1875);
vertex(251, 356.1875);
vertex(254, 355.1875);
vertex(258, 353.1875);
vertex(261, 349.1875);
vertex(261, 348.1875);
vertex(261, 347.1875);
endShape(CLOSE);
    beginShape();//planeta groc
vertex(300, 356.1875);
vertex(305, 356.1875);
vertex(308, 361.1875);
vertex(307, 365.1875);
vertex(303, 368.1875);
vertex(298, 366.1875);
vertex(296, 361.1875);
endShape(CLOSE);
    beginShape();//planeta dalt
vertex(317, 111.1875);
vertex(324, 110.1875);
vertex(329, 112.1875);
vertex(333, 115.1875);
vertex(336, 121.1875);
vertex(336, 126.1875);
vertex(334, 131.1875);
vertex(331, 135.1875);
vertex(326, 137.1875);
vertex(320, 136.1875);
vertex(314, 134.1875);
vertex(310, 127.1875);
vertex(309, 120.1875);
vertex(313, 115.1875);
vertex(317, 111.1875);
vertex(318, 115.1875);
vertex(321, 118.1875);
vertex(325, 120.1875);
vertex(329, 124.1875);
vertex(328, 126.1875);
vertex(323, 127.1875);
vertex(318, 124.1875);
vertex(314, 120.1875);
vertex(310, 119.1875);
vertex(312, 123.1875);
vertex(314, 126.1875);
vertex(317, 129.1875);
vertex(322, 131.1875);
vertex(326, 131.1875);
vertex(331, 128.1875);
vertex(333, 123.1875);
vertex(332, 117.1875);
vertex(330, 114.1875);
endShape(CLOSE);
    beginShape();//planeta dalt mig
vertex(258, 133.1875);
vertex(256, 135.1875);
vertex(256, 138.1875);
vertex(258, 138.1875);
vertex(260, 138.1875);
vertex(261, 136.1875);
vertex(260, 133.1875);
vertex(257, 130.1875);
vertex(253, 128.1875);
vertex(248, 128.1875);
vertex(245, 132.1875);
vertex(245, 138.1875);
vertex(248, 141.1875);
vertex(252, 142.1875);
vertex(255, 141.1875);
endShape(CLOSE);
    beginShape();//caixa de música
vertex(167, 133.1875);
vertex(174, 129.1875);
vertex(177, 111.1875);
vertex(170, 115.1875);
vertex(166, 134.1875);
vertex(181, 140.1875);
vertex(189, 135.1875);
vertex(175, 130.1875);
vertex(177, 111.1875);
vertex(194, 117.1875);
vertex(189, 135.1875);
vertex(181, 140.1875);
endShape(CLOSE);

   // Dibuix d'un arc de Sant Martí
   let radius = 50;
   let colors = ['#FF0000', '#FF7F00', '#FFFF00', '#00FF00', '#0000FF', '#4B0082', '#8B00FF']; // Colors de l'arc de Sant Martí

   for (let i = 0; i < colors.length; i++) {
       stroke(colors[i]);
       noFill();
       arc(0, 0, radius + i * 10, radius + i * 10, PI, TWO_PI); // Dibuixar arcs concèntrics amb diferents colors
   }
}

function handleFileUpload(event) {
   let file = event.target.files[0];
   if (file && file.type.startsWith('audio/')) {
       let fileURL = URL.createObjectURL(file);

       // Update audio player with the new audio file
       const audioElement = document.getElementById('player');
       const defaultAudioElement = document.getElementById('default-player');
       audioElement.src = fileURL;
       defaultAudioElement.src = fileURL;

       if (player) {
           player.source = {
               type: 'audio',
               sources: [{ src: fileURL, type: file.type }]
           };
       }

       // Update song title
       const songTitleElement = document.getElementById('song-title');
       songTitleElement.textContent = file.name;

       // Load sound for p5.js analysis
       loadSound(fileURL, soundLoaded);
   } else {
       console.error('Please upload a valid audio file');
   }
}

function soundLoaded(loadedSong) {
   if (song && song.isPlaying()) {
       song.stop();
   }
   song = loadedSong;
   song.play();
   amplitude.setInput(song);
   fft.setInput(song);
}
</script>

</body>
</html>
